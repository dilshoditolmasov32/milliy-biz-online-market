import{a8 as q,b as R,j as e,a5 as te,a4 as ae,r as B,a9 as G,aa as se,ab as T,ac as ne,ad as re,ae as ie,a3 as ce}from"./index-B41o97T_.js";import{N as le}from"./Nav-Bfp2WwnM.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],de=q("Check",oe);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M5 12h14",key:"1ays0h"}]],fe=q("Minus",ue);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],he=q("Plus",me);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],xe=q("Trash2",_e),pe="data:image/svg+xml,%3csvg%20width='194'%20height='216'%20viewBox='0%200%20194%20216'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_f_180_4354)'%3e%3crect%20x='24.1875'%20y='178.94'%20width='124'%20height='12.03'%20fill='%231B3554'/%3e%3c/g%3e%3crect%20x='25.1875'%20y='14.53'%20width='124'%20height='79.1975'%20fill='%23E0E5EC'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M25.1875%2014.53V134.83H5.1875V62.0852L15.1891%2046.6966L25.1875%2014.53Z'%20fill='%23CFD4DC'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M148.188%2014.53V134.83H168.188V62.0852L158.186%2046.6966L148.188%2014.53Z'%20fill='%23CFD4DC'/%3e%3cpath%20d='M5.1875%2061.6475H168.188V198C168.188%20200.761%20165.949%20203%20163.188%20203H10.1875C7.42608%20203%205.1875%20200.761%205.1875%20198V61.6475Z'%20fill='white'/%3e%3cpath%20opacity='0.5'%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M54.1875%20117.332C54.1875%20116.632%2054.5467%20115.98%2055.1685%20115.658C56.5521%20114.942%2059.196%20113.778%2061.7653%20113.778C64.3337%20113.778%2066.9021%20114.941%2068.2403%20115.658C68.8433%20115.981%2069.1875%20116.619%2069.1875%20117.303C69.1875%20118.917%2067.3273%20119.975%2065.8088%20119.427C64.5938%20118.99%2063.1665%20118.636%2061.7275%20118.636C60.2599%20118.636%2058.7922%20119.004%2057.5471%20119.454C56.0314%20120.001%2054.1875%20118.943%2054.1875%20117.332Z'%20fill='%231B3554'/%3e%3cpath%20opacity='0.5'%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M105.188%20117.332C105.188%20116.632%20105.547%20115.98%20106.168%20115.658C107.552%20114.942%20110.196%20113.778%20112.765%20113.778C115.334%20113.778%20117.902%20114.941%20119.24%20115.658C119.843%20115.981%20120.188%20116.619%20120.188%20117.303C120.188%20118.917%20118.327%20119.975%20116.809%20119.427C115.594%20118.99%20114.166%20118.636%20112.727%20118.636C111.26%20118.636%20109.792%20119.004%20108.547%20119.454C107.031%20120.001%20105.188%20118.943%20105.188%20117.332Z'%20fill='%231B3554'/%3e%3cellipse%20opacity='0.5'%20cx='87.1875'%20cy='137.84'%20rx='16'%20ry='7.02054'%20fill='%231B3554'/%3e%3cellipse%20opacity='0.149343'%20cx='50.1875'%20cy='76.685'%20rx='6'%20ry='6.015'%20fill='%231B3554'/%3e%3cellipse%20opacity='0.149343'%20cx='123.188'%20cy='76.685'%20rx='6'%20ry='6.015'%20fill='%231B3554'/%3e%3cpath%20d='M50.1875%2076.3768V39.0913C50.1875%2018.8825%2066.5291%202.5%2086.6875%202.5C106.846%202.5%20123.188%2018.8825%20123.188%2039.0913V76.3768'%20stroke='%235E7085'%20stroke-width='5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20filter='url(%23filter1_d_180_4354)'%3e%3cellipse%20cx='167.788'%20cy='175.532'%20rx='17.6'%20ry='17.644'%20fill='%23E31E25'/%3e%3c/g%3e%3cpath%20d='M174.881%20169.609C175.74%20170.47%20175.74%20171.866%20174.881%20172.727L171.618%20175.998L174.881%20179.268C175.81%20180.2%20175.81%20181.71%20174.881%20182.642C173.952%20183.573%20172.445%20183.573%20171.516%20182.642L168.253%20179.371L164.991%20182.642C164.132%20183.503%20162.74%20183.503%20161.881%20182.642C161.022%20181.781%20161.022%20180.385%20161.881%20179.524L165.144%20176.253L161.881%20172.982C160.952%20172.051%20160.952%20170.541%20161.881%20169.609C162.81%20168.678%20164.316%20168.678%20165.246%20169.609L168.508%20172.88L171.771%20169.609C172.63%20168.748%20174.022%20168.748%20174.881%20169.609Z'%20fill='white'/%3e%3cdefs%3e%3cfilter%20id='filter0_f_180_4354'%20x='0.000555038'%20y='154.753'%20width='172.374'%20height='60.4039'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='BackgroundImageFix'%20result='shape'/%3e%3cfeGaussianBlur%20stdDeviation='12.0935'%20result='effect1_foregroundBlur_180_4354'/%3e%3c/filter%3e%3cfilter%20id='filter1_d_180_4354'%20x='142.188'%20y='151.888'%20width='51.1992'%20height='51.288'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='2'/%3e%3cfeGaussianBlur%20stdDeviation='4'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%201%200%200%200%200%200.415686%200%200%200%200%200.596078%200%200%200%200.3%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_180_4354'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_180_4354'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e";function ye(){const{t,i18n:s}=R();return e.jsxs("div",{className:"no-product",children:[e.jsx("img",{src:pe,alt:"bag-image"}),e.jsxs("div",{className:"no-product__desc",children:[e.jsx("p",{className:"no-product__title",children:t("emptyCart")}),e.jsx("p",{className:"no-product__text",children:t("emptyCartText")})]})]})}const ge=()=>{var C;const t=te(),{cart:s,loading:u}=ae(h=>h.cart),[y,c]=B.useState(!1),[n,d]=B.useState(null),x=()=>{t(G())},f=async(h,j=1)=>{var v;c(!0),d(null);try{await se(h,j),t(G())}catch(l){throw d(((v=l.response)==null?void 0:v.data)||l.message),l}finally{c(!1)}},g=(h,j)=>{const v=s.data.items.map(l=>l.id===h?{...l,quantity:j}:l);t({type:"cart/fetchCart/fulfilled",payload:{...s,data:{...s.data,items:v}}})},m=async h=>{try{await removeCartItem(h),t(G())}catch(j){console.error(j)}};return{cart:s,cartItems:((C=s==null?void 0:s.data)==null?void 0:C.items)||[],fullCart:s==null?void 0:s.data,getCart:x,addItem:f,loading:y||u,error:n,updateLocalCart:g,removeItem:m}};var $,z;function je(){if(z)return $;z=1;var t="Expected a function",s=NaN,u="[object Symbol]",y=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,d=/^0o[0-7]+$/i,x=parseInt,f=typeof T=="object"&&T&&T.Object===Object&&T,g=typeof self=="object"&&self&&self.Object===Object&&self,m=f||g||Function("return this")(),C=Object.prototype,h=C.toString,j=Math.max,v=Math.min,l=function(){return m.Date.now()};function Q(a,i,_){var k,I,E,N,o,b,L=0,P=!1,M=!1,O=!0;if(typeof a!="function")throw new TypeError(t);i=H(i)||0,F(_)&&(P=!!_.leading,M="maxWait"in _,E=M?j(H(_.maxWait)||0,i):E,O="trailing"in _?!!_.trailing:O);function V(r){var p=k,w=I;return k=I=void 0,L=r,N=a.apply(w,p),N}function J(r){return L=r,o=setTimeout(S,i),P?V(r):N}function K(r){var p=r-b,w=r-L,A=i-p;return M?v(A,E-w):A}function U(r){var p=r-b,w=r-L;return b===void 0||p>=i||p<0||M&&w>=E}function S(){var r=l();if(U(r))return Z(r);o=setTimeout(S,K(r))}function Z(r){return o=void 0,O&&k?V(r):(k=I=void 0,N)}function Y(){o!==void 0&&clearTimeout(o),L=0,k=b=I=o=void 0}function ee(){return o===void 0?N:Z(l())}function D(){var r=l(),p=U(r);if(k=arguments,I=this,b=r,p){if(o===void 0)return J(b);if(M)return o=setTimeout(S,i),V(b)}return o===void 0&&(o=setTimeout(S,i)),N}return D.cancel=Y,D.flush=ee,D}function F(a){var i=typeof a;return!!a&&(i=="object"||i=="function")}function W(a){return!!a&&typeof a=="object"}function X(a){return typeof a=="symbol"||W(a)&&h.call(a)==u}function H(a){if(typeof a=="number")return a;if(X(a))return s;if(F(a)){var i=typeof a.valueOf=="function"?a.valueOf():a;a=F(i)?i+"":i}if(typeof a!="string")return a===0?a:+a;a=a.replace(y,"");var _=n.test(a);return _||d.test(a)?x(a.slice(2),_?2:8):c.test(a)?s:+a}return $=Q,$}var be=je();const Ce=ne(be);function ve({prod:t,refresh:s}){var f;const{product:u}=t,{t:y}=R(),[c,n]=B.useState(t.quantity);B.useEffect(()=>{n(t.quantity)},[t.quantity]);const d=B.useCallback(Ce(async(g,m)=>{try{await re(g,m),s()}catch(C){console.error("Xatolik:",C),n(t.quantity)}},500),[t.quantity,s]),x=g=>{const m=c+g;m<1||(n(m),d(t.id,m))};return e.jsxs("div",{className:"cart-elem",children:[e.jsx("div",{className:"cart-elem__select checked",children:e.jsx(de,{size:16})}),e.jsx("div",{className:"cart-elem__img-wrap",children:e.jsx("img",{src:(f=u==null?void 0:u.base_image)==null?void 0:f.small_image_url,alt:t.name,style:{width:"100%",height:"100%",objectFit:"contain"}})}),e.jsxs("div",{className:"cart-elem__info",children:[e.jsx("div",{className:"cart-elem__top",children:e.jsxs("div",{className:"cart-elem__price",children:[t.formatted_price,t.base_discount_amount>0&&e.jsxs("span",{className:"cart-elem__badge",children:["-",Math.round(t.base_discount_amount),"%"]})]})}),e.jsx("p",{className:"cart-elem__name",children:t.name}),e.jsxs("p",{className:"cart-elem__code",children:[y("product_code"),": ",t.sku||t.id]})]}),e.jsxs("div",{className:"cart-elem__controls",children:[e.jsxs("div",{className:"qty",children:[e.jsx("button",{className:"qty__btn",onClick:()=>x(-1),disabled:c<=1,children:e.jsx(fe,{size:16})}),e.jsx("span",{className:"qty__num",children:c}),e.jsx("button",{className:"qty__btn",onClick:()=>x(1),children:e.jsx(he,{size:16})})]}),e.jsx("button",{className:"del",onClick:()=>ie(t.id).then(s),children:e.jsx(xe,{size:20})})]})]})}function Be(){const{t}=R(),{cart:s,cartItems:u,loading:y,getCart:c}=ge(),n=(s==null?void 0:s.data)||s,d=u||[];if(B.useEffect(()=>{c()},[]),y&&d.length===0)return e.jsxs("div",{className:"loading",children:[t("loading"),"..."]});const x=()=>{ce.success(t("success_order"))};return e.jsxs(e.Fragment,{children:[e.jsx(le,{info:{title:t("myCart"),total:(n==null?void 0:n.items_qty)||0}}),d.length>0?e.jsx("div",{className:"basket",children:e.jsxs("div",{className:"basket__wrap",children:[e.jsx("div",{className:"basket__prods",children:d.map(f=>e.jsx(ve,{prod:f,refresh:c},f.id))}),e.jsxs("div",{className:"basket__total",children:[e.jsxs("div",{className:"basket__total-top",children:[e.jsx("h2",{className:"basket__total-title",children:t("total")}),e.jsxs("div",{className:"basket__total-desc",children:[e.jsx("span",{className:"basket__total-desc__text",children:n==null?void 0:n.formatted_grand_total}),(n==null?void 0:n.formatted_sub_total)&&e.jsx("span",{className:"basket__total-desc__old",children:n.formatted_sub_total})]})]}),e.jsx("div",{className:"basket__total-categ",children:e.jsxs("div",{className:"basket__total-categ__text",children:[e.jsx("span",{children:t("products_in_cart")}),e.jsxs("span",{children:[n==null?void 0:n.items_qty," ",t("count_unit")]})]})}),e.jsx("button",{className:"basket__total-btn",onClick:x,children:t("checkout")})]})]})}):e.jsx(ye,{})]})}export{Be as default};
